<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input id="ID_FILE_UPLOADER" type="file">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</body>
</html>

<script>

    $("#ID_FILE_UPLOADER").on('change', async (e) => {
        // upload file
        const file = {
            inf: e.target.files[0],
            ctx: await CLIENT_FILE.TO_BASE64(e.target.files[0]).catch((error) => console.log("Error uploading your file."))
        }
        const fobj = new CLIENT_FILE(file.inf, file.ctx)
		console.log(fobj);return;
        const aes = new AES("getItem");
        const [NAM, CTX, IMP] = fobj.ENCRYPT(aes);
        console.log(NAM, CTX, IMP);
    });

    class CLIENT_FILE {

        constructor(fileinf, filectx){
            this.name = fileinf.name
            this.size = {value: fileinf.size, unit: "bytes"}
            this.ctx = filectx;
            this.all = fileinf;
        }

        static TO_BASE64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        static FORMAT_NAM = (NAM) => {
            
        }   

        ENCRYPT = (aes, hash) => {
            const NAM = CLIENT_FILE.FORMAT_NAM(aes.encrypt(this.name, true));
            const CTX = aes.encrypt(this.ctx, true);
            const IMP = hash(NAM + CTX)
            return [NAM,CTX,IMP];
        }
    }

</script>
